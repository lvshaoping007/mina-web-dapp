let account;const initializeMina=async()=>{const n=document.getElementById("connectButton"),e=document.getElementById("getAccounts"),t=document.getElementById("getAccountsResult");n.onclick=()=>{console.log("onboardButton"),window.oasis?(n.innerText="Onboarding in progress",window.oasis.requestAccounts().then((e=>{console.log("requestAccounts==0",e),Array.isArray(e)&&e.length>0?(console.log("requestAccounts==0",e),account=e,document.getElementById("accounts").innerHTML=e,n.innerText="Connected",n.disabled=!0):(console.log("requestAccounts==1",e),n.innerText=e.error)}))):alert("请先安装oasis-extension-wallet")},e.onclick=async()=>{window.oasis&&(account=await window.oasis.getAccounts(),Array.isArray(account)&&account.length>0&&(t.innerHTML=account||"Not able to get accounts"))};const o=document.getElementById("sendButton"),c=document.getElementById("sendAmountInput"),s=document.getElementById("receiveAddressInput"),a=document.getElementById("sendResultDisplay");o.onclick=async()=>{let n=account&&account.length>0?account[0]:"",e=await window.oasis.signTransaction({amount:c.value,from:n,to:s.value});a.innerHTML=e.error||e.hash};const d=document.getElementById("addEscrowButton"),i=document.getElementById("addEscrowAmountInput"),u=document.getElementById("vaildatorAddressInput"),r=document.getElementById("addEscrowResultDisplay");function l(e){Array.isArray(e)&&(document.getElementById("accounts").innerHTML=e,0===e.length&&(n.innerText="Connect",n.disabled=!1))}d.onclick=async()=>{let n=await window.oasis.signAddEscrow({amount:i.value,from:account.address,to:u.value});r.innerHTML=n.error||n.hash},setTimeout((()=>{!async function(){window.oasis&&(account=await window.oasis.getAccounts(),Array.isArray(account)&&account.length>0&&(n.innerText="Connected",n.disabled=!0,document.getElementById("accounts").innerHTML=account[0]||""))}(),window.oasis&&window.oasis.onAccountChange("accountsChanged",l)}),200)};window.addEventListener("DOMContentLoaded",initializeMina);